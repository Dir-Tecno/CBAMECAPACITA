2025-04-28 12:54:22,012 - INFO - Configuración de Hugging Face cargada correctamente
2025-04-28 12:54:22,017 - INFO - Descargando archivo desde Hugging Face: Dir-Tecno/CBAMECAPACITA
2025-04-28 12:54:24,191 - INFO - Datos cargados exitosamente: 251288 registros
2025-04-28 12:54:26,009 - ERROR - Error al cargar datos: Traceback (most recent call last):
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3298, in raw_connection
    return self.pool.connect()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 713, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 675, in __init__
    self.__connect()
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
    with util.safe_reraise():
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 897, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/create.py", line 646, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 625, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
                  ^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1049, "Unknown database 'netznet'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/src/pages/comparar_cursos.py", line 40, in load_data
    df_historico = pd.read_sql(query_historico, engine)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pandas/io/sql.py", line 704, in read_sql
    with pandasSQL_builder(con) as pandas_sql:
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pandas/io/sql.py", line 906, in pandasSQL_builder
    return SQLDatabase(con, schema, need_transaction)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pandas/io/sql.py", line 1636, in __init__
    con = self.exit_stack.enter_context(con.connect())
                                        ^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3274, in connect
    return self._connection_cls(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 148, in __init__
    Connection._handle_dbapi_exception_noconnection(
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2439, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3298, in raw_connection
    return self.pool.connect()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 713, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 675, in __init__
    self.__connect()
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
    with util.safe_reraise():
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 897, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/create.py", line 646, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 625, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
                  ^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1049, "Unknown database 'netznet'")
(Background on this error at: https://sqlalche.me/e/20/e3q8)

2025-04-28 12:56:09,336 - INFO - Configuración de Hugging Face cargada correctamente
2025-04-28 12:56:12,960 - ERROR - Error al cargar datos: Traceback (most recent call last):
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.ProgrammingError: (1146, "Table 'CBAMECAPACITA.T_CURSOS_HISTORICOS' doesn't exist")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/src/pages/comparar_cursos.py", line 40, in load_data
    df_historico = pd.read_sql(query_historico, engine)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pandas/io/sql.py", line 734, in read_sql
    return pandas_sql.read_query(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pandas/io/sql.py", line 1836, in read_query
    result = self.execute(sql, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pandas/io/sql.py", line 1659, in execute
    return self.con.exec_driver_sql(sql, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1776, in exec_driver_sql
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.ProgrammingError: (pymysql.err.ProgrammingError) (1146, "Table 'CBAMECAPACITA.T_CURSOS_HISTORICOS' doesn't exist")
[SQL: SELECT * FROM T_CURSOS_HISTORICOS]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-04-28 12:57:50,087 - INFO - Configuración de Hugging Face cargada correctamente
2025-04-28 13:04:18,065 - INFO - Configuración de Hugging Face cargada correctamente
2025-04-28 13:05:11,599 - ERROR - Error en análisis de compatibilidad: Traceback (most recent call last):
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'id_certificacion'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/src/pages/comparar_cursos.py", line 109, in analizar_compatibilidad
    df_certificaciones['id_certificacion'].unique(),
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'id_certificacion'

2025-04-28 13:08:45,799 - INFO - Configuración de Hugging Face cargada correctamente
2025-04-28 13:08:49,391 - ERROR - Error al cargar datos: Traceback (most recent call last):
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1054, "Unknown column 'N_INSTITUCION' in 'SELECT'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/src/pages/comparar_cursos.py", line 44, in load_data
    df_historico = pd.read_sql(query_historico, engine)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pandas/io/sql.py", line 734, in read_sql
    return pandas_sql.read_query(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pandas/io/sql.py", line 1836, in read_query
    result = self.execute(sql, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pandas/io/sql.py", line 1659, in execute
    return self.con.exec_driver_sql(sql, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1776, in exec_driver_sql
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1054, "Unknown column 'N_INSTITUCION' in 'SELECT'")
[SQL: 
            SELECT DISTINCT N_CURSO, N_SECTOR, N_INSTITUCION 
            FROM T_CURSOS_HISTORICO 
            ORDER BY N_CURSO
        ]
(Background on this error at: https://sqlalche.me/e/20/e3q8)

2025-04-28 13:09:07,858 - INFO - Configuración de Hugging Face cargada correctamente
2025-04-28 13:09:18,593 - ERROR - Error en análisis de compatibilidad: Traceback (most recent call last):
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'id_certificacion'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/src/pages/comparar_cursos.py", line 113, in analizar_compatibilidad
    df_certificaciones['id_certificacion'].unique(),
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'id_certificacion'

2025-04-28 13:09:34,195 - INFO - Configuración de Hugging Face cargada correctamente
2025-04-28 13:09:44,791 - ERROR - Error en análisis de compatibilidad: Traceback (most recent call last):
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'id_certificacion'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/src/pages/comparar_cursos.py", line 113, in analizar_compatibilidad
    df_certificaciones['id_certificacion'].unique(),
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'id_certificacion'

2025-04-28 13:14:04,750 - INFO - Configuración de Hugging Face cargada correctamente
2025-04-28 13:14:15,909 - ERROR - Error en análisis de compatibilidad: Traceback (most recent call last):
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'id_certificacion'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/src/pages/comparar_cursos.py", line 113, in analizar_compatibilidad
    df_certificaciones['id_certificacion'].unique(),
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'id_certificacion'

2025-04-28 13:14:34,383 - INFO - Configuración de Hugging Face cargada correctamente
2025-04-28 13:14:45,388 - ERROR - Error en análisis de compatibilidad: Traceback (most recent call last):
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'id_certificacion'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/src/pages/comparar_cursos.py", line 134, in analizar_compatibilidad
    df_certificaciones['id_certificacion'].unique(),
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'id_certificacion'

2025-04-28 13:15:16,119 - INFO - Configuración de Hugging Face cargada correctamente
2025-04-28 13:15:29,739 - ERROR - Error al cargar equivalencias: Traceback (most recent call last):
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.ProgrammingError: (1146, "Table 'CBAMECAPACITA.T_EQUIVALENCIAS_CURSOS' doesn't exist")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/src/pages/comparar_cursos.py", line 179, in analizar_compatibilidad
    df_equivalencias = pd.read_sql(query, engine)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pandas/io/sql.py", line 734, in read_sql
    return pandas_sql.read_query(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pandas/io/sql.py", line 1836, in read_query
    result = self.execute(sql, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pandas/io/sql.py", line 1659, in execute
    return self.con.exec_driver_sql(sql, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1776, in exec_driver_sql
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.ProgrammingError: (pymysql.err.ProgrammingError) (1146, "Table 'CBAMECAPACITA.T_EQUIVALENCIAS_CURSOS' doesn't exist")
[SQL: 
                        SELECT * FROM T_EQUIVALENCIAS_CURSOS
                        ORDER BY fecha_creacion DESC
                    ]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-04-28 13:18:17,814 - INFO - Configuración de Hugging Face cargada correctamente
2025-04-28 13:18:31,451 - ERROR - Error al cargar equivalencias: Traceback (most recent call last):
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1054, "Unknown column 'c.nombre_certificacion' in 'SELECT'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/src/pages/comparar_cursos.py", line 177, in analizar_compatibilidad
    df_equivalencias = pd.read_sql(query, engine)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pandas/io/sql.py", line 734, in read_sql
    return pandas_sql.read_query(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pandas/io/sql.py", line 1836, in read_query
    result = self.execute(sql, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pandas/io/sql.py", line 1659, in execute
    return self.con.exec_driver_sql(sql, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1776, in exec_driver_sql
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1054, "Unknown column 'c.nombre_certificacion' in 'SELECT'")
[SQL: 
                        SELECT 
                            ec.id_equivalencia,
                            ec.n_curso,
                            ec.n_certificacion,
                            c.nombre_certificacion,
                            ec.fecha_creacion
                        FROM T_EQUIVALENCIAS_CURSOS ec
                        LEFT JOIN T_CERTIF_X_LOCALIDAD c ON ec.n_certificacion = c.N_CERTIFICACION
                        ORDER BY ec.fecha_creacion DESC
                    ]
(Background on this error at: https://sqlalche.me/e/20/e3q8)

2025-04-28 13:18:39,043 - INFO - Configuración de Hugging Face cargada correctamente
2025-04-28 13:18:52,623 - ERROR - Error al guardar equivalencia: Traceback (most recent call last):
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/src/pages/comparar_cursos.py", line 151, in analizar_compatibilidad
    conn.execute("""
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1410, in execute
    distilled_parameters = _distill_params_20(parameters)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "lib/sqlalchemy/cyextension/util.pyx", line 32, in sqlalchemy.cyextension.util._distill_params_20
  File "lib/sqlalchemy/cyextension/util.pyx", line 23, in sqlalchemy.cyextension.util._check_item
sqlalchemy.exc.ArgumentError: List argument must consist only of tuples or dictionaries

2025-04-28 13:18:55,337 - ERROR - Error al cargar equivalencias: Traceback (most recent call last):
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1054, "Unknown column 'c.nombre_certificacion' in 'SELECT'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/src/pages/comparar_cursos.py", line 177, in analizar_compatibilidad
    df_equivalencias = pd.read_sql(query, engine)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pandas/io/sql.py", line 734, in read_sql
    return pandas_sql.read_query(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pandas/io/sql.py", line 1836, in read_query
    result = self.execute(sql, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pandas/io/sql.py", line 1659, in execute
    return self.con.exec_driver_sql(sql, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1776, in exec_driver_sql
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1054, "Unknown column 'c.nombre_certificacion' in 'SELECT'")
[SQL: 
                        SELECT 
                            ec.id_equivalencia,
                            ec.n_curso,
                            ec.n_certificacion,
                            c.nombre_certificacion,
                            ec.fecha_creacion
                        FROM T_EQUIVALENCIAS_CURSOS ec
                        LEFT JOIN T_CERTIF_X_LOCALIDAD c ON ec.n_certificacion = c.N_CERTIFICACION
                        ORDER BY ec.fecha_creacion DESC
                    ]
(Background on this error at: https://sqlalche.me/e/20/e3q8)

2025-04-28 13:19:32,166 - INFO - Configuración de Hugging Face cargada correctamente
2025-04-28 13:19:45,884 - ERROR - Error al cargar equivalencias: Traceback (most recent call last):
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1054, "Unknown column 'ec.fecha_creacion' in 'SELECT'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/src/pages/comparar_cursos.py", line 175, in analizar_compatibilidad
    df_equivalencias = pd.read_sql(query, engine)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pandas/io/sql.py", line 734, in read_sql
    return pandas_sql.read_query(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pandas/io/sql.py", line 1836, in read_query
    result = self.execute(sql, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pandas/io/sql.py", line 1659, in execute
    return self.con.exec_driver_sql(sql, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1776, in exec_driver_sql
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1054, "Unknown column 'ec.fecha_creacion' in 'SELECT'")
[SQL: 
                        SELECT 
                            ec.id_equivalencia,
                            ec.n_curso,
                            ec.n_certificacion,
                            ec.fecha_creacion
                        FROM T_EQUIVALENCIAS_CURSOS ec
                        ORDER BY ec.fecha_creacion DESC
                    ]
(Background on this error at: https://sqlalche.me/e/20/e3q8)

2025-04-28 13:21:14,440 - INFO - Configuración de Hugging Face cargada correctamente
2025-04-28 13:21:31,783 - INFO - Configuración de Hugging Face cargada correctamente
2025-04-28 13:21:44,172 - ERROR - Error al guardar equivalencia: Traceback (most recent call last):
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/src/pages/comparar_cursos.py", line 151, in analizar_compatibilidad
    conn.execute("""
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1410, in execute
    distilled_parameters = _distill_params_20(parameters)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "lib/sqlalchemy/cyextension/util.pyx", line 32, in sqlalchemy.cyextension.util._distill_params_20
  File "lib/sqlalchemy/cyextension/util.pyx", line 23, in sqlalchemy.cyextension.util._check_item
sqlalchemy.exc.ArgumentError: List argument must consist only of tuples or dictionaries

2025-04-28 13:24:09,787 - INFO - Configuración de Hugging Face cargada correctamente
2025-04-28 13:24:26,164 - INFO - Configuración de Hugging Face cargada correctamente
2025-04-28 13:24:38,973 - ERROR - Error al guardar equivalencia: Traceback (most recent call last):
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1412, in execute
    meth = statement._execute_on_connection
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute '_execute_on_connection'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/src/pages/comparar_cursos.py", line 152, in analizar_compatibilidad
    conn.execute("""
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1414, in execute
    raise exc.ObjectNotExecutableError(statement) from err
sqlalchemy.exc.ObjectNotExecutableError: Not an executable object: '\n                                INSERT INTO T_EQUIVALENCIAS_CURSOS (n_curso, n_certificacion)\n                                VALUES (%s, %s)\n                            '

2025-04-28 13:26:05,523 - INFO - Configuración de Hugging Face cargada correctamente
2025-04-28 13:26:25,565 - INFO - Configuración de Hugging Face cargada correctamente
2025-04-28 13:26:43,037 - INFO - Configuración de Hugging Face cargada correctamente
2025-04-28 13:26:55,916 - ERROR - Error al guardar equivalencia: Traceback (most recent call last):
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.DataError: (1406, "Data too long for column 'n_certificacion' at row 1")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/src/pages/comparar_cursos.py", line 156, in analizar_compatibilidad
    conn.execute(sql, {"curso": curso_historico, "cert": certificacion})
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.DataError: (pymysql.err.DataError) (1406, "Data too long for column 'n_certificacion' at row 1")
[SQL: 
                                INSERT INTO T_EQUIVALENCIAS_CURSOS (n_curso, n_certificacion)
                                VALUES (%(curso)s, %(cert)s)
                            ]
[parameters: {'curso': 'Acabado de Madera', 'cert': 'AUXILIAR EN CONSTRUCCIONES - CONSTRUCCIÓN EN BASE HÚMEDA'}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)

2025-04-28 13:27:51,195 - INFO - Configuración de Hugging Face cargada correctamente
2025-04-28 13:28:21,432 - INFO - Configuración de Hugging Face cargada correctamente
2025-04-28 13:29:47,775 - INFO - Configuración de Hugging Face cargada correctamente
2025-04-28 13:29:48,994 - INFO - Configuración de Hugging Face cargada correctamente
2025-04-28 13:31:08,786 - INFO - Configuración de Hugging Face cargada correctamente
2025-04-28 13:40:35,682 - INFO - Configuración de Hugging Face cargada correctamente
2025-04-28 13:40:49,886 - ERROR - Error al guardar equivalencia: Traceback (most recent call last):
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry 'Acabado de Madera-AUXILIAR EN CONSTRUCCIONES - CONSTRUCCIÓN ...' for key 'UC_Equivalencia'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/src/pages/comparar_cursos.py", line 156, in analizar_compatibilidad
    conn.execute(sql, {"curso": curso_historico, "cert": certificacion})
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry 'Acabado de Madera-AUXILIAR EN CONSTRUCCIONES - CONSTRUCCIÓN ...' for key 'UC_Equivalencia'")
[SQL: 
                                INSERT INTO T_EQUIVALENCIAS_CURSOS (n_curso, n_certificacion)
                                VALUES (%(curso)s, %(cert)s)
                            ]
[parameters: {'curso': 'Acabado de Madera', 'cert': 'AUXILIAR EN CONSTRUCCIONES - CONSTRUCCIÓN EN BASE HÚMEDA'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-04-28 13:40:56,370 - INFO - Configuración de Hugging Face cargada correctamente
2025-04-28 13:40:57,295 - INFO - Configuración de Hugging Face cargada correctamente
2025-04-28 13:56:09,988 - INFO - Configuración de Hugging Face cargada correctamente
2025-04-28 13:56:09,991 - INFO - Descargando archivo desde Hugging Face: Dir-Tecno/CBAMECAPACITA
2025-04-28 13:56:12,243 - INFO - Datos cargados exitosamente: 251288 registros
2025-04-28 14:55:22,998 - INFO - Configuración de Hugging Face cargada correctamente
2025-04-28 14:55:23,001 - INFO - Descargando archivo desde Hugging Face: Dir-Tecno/CBAMECAPACITA
2025-04-28 14:55:25,708 - INFO - Datos cargados exitosamente: 251288 registros
2025-04-28 15:47:31,732 - INFO - Configuración de Hugging Face cargada correctamente
2025-04-28 15:47:31,737 - INFO - Descargando archivo desde Hugging Face: Dir-Tecno/CBAMECAPACITA
2025-04-28 15:47:33,964 - INFO - Datos cargados exitosamente: 251288 registros
2025-04-28 15:48:04,878 - INFO - Configuración de Hugging Face cargada correctamente
2025-04-28 15:54:02,015 - INFO - Configuración de Hugging Face cargada correctamente
2025-04-28 15:55:51,249 - INFO - Configuración de Hugging Face cargada correctamente
2025-04-28 15:58:00,896 - INFO - Configuración de Hugging Face cargada correctamente
2025-04-28 15:58:12,530 - ERROR - Error al cargar equivalencias: Traceback (most recent call last):
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1054, "Unknown column 'eq.estado' in 'WHERE'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/src/pages/comparar_cursos.py", line 204, in analizar_compatibilidad
    df_equivalencias = pd.read_sql(query, engine)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pandas/io/sql.py", line 734, in read_sql
    return pandas_sql.read_query(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pandas/io/sql.py", line 1836, in read_query
    result = self.execute(sql, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pandas/io/sql.py", line 1659, in execute
    return self.con.exec_driver_sql(sql, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1776, in exec_driver_sql
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/lucasalvador/Reportes/CBAMECAPACITA/venv/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1054, "Unknown column 'eq.estado' in 'WHERE'")
[SQL: 
                        SELECT 
                            eq.id_equivalencia,
                            eq.n_curso as curso_historico,
                            eq.n_certificacion as certificacion_actual,
                            eq.fecha_creacion,
                            eq.usuario_creacion,
                            eq.observaciones
                        FROM T_EQUIVALENCIAS_CURSOS eq
                        WHERE eq.estado = TRUE
                        ORDER BY eq.fecha_creacion DESC
                    ]
(Background on this error at: https://sqlalche.me/e/20/e3q8)

2025-04-28 16:01:02,411 - INFO - Configuración de Hugging Face cargada correctamente
